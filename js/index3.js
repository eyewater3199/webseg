const _0x90c7=['error','456301hwwHJi','same','dataSync','./js/thread.js','tensor','getElementById','greater','843734PjBoQd','1fyVOWn','4AqoyPv','div','523952NLZCVD','170441JZGejS','array','tidy','max','browser','mul','onmessage','sub','toPixels','width','fromPixels','squeeze','225521WcfPyM','nextFrame','scalar','conv2d','200632tijych','getContext','data','shape','1mtlFDL','2fWyaMJ','dispose','square','modelIsReady','webcam','450587cWYXZE','height','resizeBilinear','min','capture'];const _0x4912=function(_0x1e0553,_0x2a8f2b){_0x1e0553=_0x1e0553-0x12e;let _0x90c71f=_0x90c7[_0x1e0553];return _0x90c71f;};const _0x4a5885=_0x4912;(function(_0x236f4f,_0x37a96a){const _0x215382=_0x4912;while(!![]){try{const _0x401b31=-parseInt(_0x215382(0x137))+parseInt(_0x215382(0x143))*parseInt(_0x215382(0x134))+-parseInt(_0x215382(0x14c))*-parseInt(_0x215382(0x147))+parseInt(_0x215382(0x132))+parseInt(_0x215382(0x157))*-parseInt(_0x215382(0x14b))+-parseInt(_0x215382(0x151))+-parseInt(_0x215382(0x136))*parseInt(_0x215382(0x133));if(_0x401b31===_0x37a96a)break;else _0x236f4f['push'](_0x236f4f['shift']());}catch(_0x524728){_0x236f4f['push'](_0x236f4f['shift']());}}}(_0x90c7,0x85409));const THREAD_PATH=_0x4a5885(0x12e),MODEL_SIZE=0x80,BINARYIZATION_THRESHOLD=tf[_0x4a5885(0x145)](0.7),FLOAT_255=tf[_0x4a5885(0x145)](0xff),KERNEL=tf['tensor4d']([0.00092991,0.00223073,0.00416755,0.00606375,0.00687113,0.00606375,0.00416755,0.00223073,0.00535124,0.00999743,0.01454618,0.01648298,0.01454618,0.00999743,0.00416755,0.00999743,0.01867766,0.02717584,0.03079426,0.02717584,0.01867766,0.00606375,0.01454618,0.02717584,0.03954061,0.04480539,0.03954061,0.02717584,0.00687113,0.01648298,0.03079426,0.04480539,0.05077116,0.04480539,0.03079426,0.00606375,0.01454618,0.02717584,0.03954061,0.04480539,0.03954061,0.02717584,0.00416755,0.00999743,0.01867766,0.02717584,0.03079426,0.02717584,0.01867766],[0x7,0x7,0x1,0x1]);let use_threshold=!![],video_width=0x12c,video_height=0x12c,webcam,bg,canvasElement,outputElement,output_ctx,input_frame,output_frame,webWorker,workerModelIsReady=![],workerIsWaiting=![],isPredicting=![],bgIsUpdated=![];async function execute(){const _0x34ba62=_0x4a5885;while(!![]){bgIsUpdated&&(bg=await tf[_0x34ba62(0x13b)][_0x34ba62(0x141)](imgElement),bgIsUpdated=![]);if(webWorker&&workerModelIsReady&&!workerIsWaiting){input_frame=await webcam[_0x34ba62(0x155)]();if(isPredicting){const _0x2b3cc8=await input_frame[_0x34ba62(0x159)](),_0x1ccb0b=input_frame[_0x34ba62(0x14a)];webWorker['postMessage']({'array':_0x2b3cc8,'shape':_0x1ccb0b}),workerIsWaiting=!![];}else tf[_0x34ba62(0x13b)][_0x34ba62(0x13f)](input_frame,canvasElement),workerIsWaiting=![];}await tf[_0x34ba62(0x144)]();}}function runSegmentation(){isPredicting=!![];}function stopSegmentation(){isPredicting=![];}function tensorToPixelData(_0x9272fb){const _0x22b423=_0x4a5885,_0xc74982=_0x9272fb[_0x22b423(0x159)](),_0x9d6d1d=_0x9272fb['size'];for(let _0x4230eb=0x0;_0x4230eb<_0x9d6d1d/0x3;_0x4230eb++){output_frame[_0x22b423(0x149)][_0x4230eb*0x4+0x0]=_0xc74982[_0x4230eb*0x3+0x0]*0xff,output_frame[_0x22b423(0x149)][_0x4230eb*0x4+0x1]=_0xc74982[_0x4230eb*0x3+0x1]*0xff,output_frame[_0x22b423(0x149)][_0x4230eb*0x4+0x2]=_0xc74982[_0x4230eb*0x3+0x2]*0xff,output_frame[_0x22b423(0x149)][_0x4230eb*0x4+0x3]=0xff;}return _0x9272fb['dispose'](),output_frame;}function blending(_0x5f46f8,_0x2b0fa8){const _0x42f7cf=_0x4a5885;return tf[_0x42f7cf(0x139)](()=>{const _0x500367=_0x42f7cf;return bg['add'](_0x5f46f8['mul'](_0x2b0fa8[_0x500367(0x13e)](bg)))[_0x500367(0x135)](FLOAT_255);});}function smoothStep(_0x3239a7){return tf['tidy'](()=>{const _0x533a6c=_0x4912,_0x5ea079=tf[_0x533a6c(0x145)](0.3),_0x3434a0=tf[_0x533a6c(0x145)](0.5),_0x553d61=tf['clipByValue'](_0x3239a7['sub'](_0x5ea079)[_0x533a6c(0x135)](_0x3434a0[_0x533a6c(0x13e)](_0x5ea079)),0x0,0x1);return tf[_0x533a6c(0x14e)](_0x553d61)[_0x533a6c(0x13c)](tf['scalar'](0x3)[_0x533a6c(0x13e)](_0x553d61[_0x533a6c(0x13c)](tf[_0x533a6c(0x145)](0x2))));});}function refineMask(_0x397dc9){const _0x38b4a0=_0x4a5885;return tf[_0x38b4a0(0x139)](()=>{const _0x387cfc=_0x38b4a0,_0x4d3a82=_0x397dc9[_0x387cfc(0x153)]([video_height,video_width]),_0x48a667=_0x4d3a82['reshape']([0x1,video_height,video_width,0x1]),_0x3df0ee=tf[_0x387cfc(0x146)](_0x48a667,KERNEL,strides=[0x1,0x1],padding=_0x387cfc(0x158)),_0x1ad936=_0x3df0ee[_0x387cfc(0x142)](0x0);if(use_threshold){const _0x50bf9d=_0x1ad936[_0x387cfc(0x13e)](_0x1ad936[_0x387cfc(0x154)]())['div'](_0x1ad936[_0x387cfc(0x13a)]()[_0x387cfc(0x13e)](_0x1ad936[_0x387cfc(0x154)]())),_0x3fdbed=_0x1ad936[_0x387cfc(0x154)]()&&_0x1ad936[_0x387cfc(0x13a)]()?_0x1ad936['greater'](BINARYIZATION_THRESHOLD):_0x50bf9d[_0x387cfc(0x131)](BINARYIZATION_THRESHOLD);return smoothStep(_0x3fdbed);}return _0x1ad936;});}function processImage(_0x2b8998,_0x2f007f){const _0x1d5cec=_0x4a5885;return tf[_0x1d5cec(0x139)](()=>{return blending(refineMask(_0x2b8998),_0x2f007f);});}function postProcessCallback(_0x539af6){const _0x4419a4=_0x4a5885;if(workerModelIsReady&&workerIsWaiting){const _0x569775=tf[_0x4419a4(0x139)](()=>{const _0x3bbc76=_0x4419a4;return tf[_0x3bbc76(0x12f)](_0x539af6['data'][_0x3bbc76(0x138)],_0x539af6[_0x3bbc76(0x149)][_0x3bbc76(0x14a)]);}),_0x24aa7f=processImage(_0x569775,input_frame),_0x24b226=tensorToPixelData(_0x24aa7f);output_ctx['putImageData'](_0x24b226,0x0,0x0),input_frame['dispose'](),_0x569775[_0x4419a4(0x14d)](),_0x24aa7f[_0x4419a4(0x14d)](),workerIsWaiting=![];}_0x539af6['data'][_0x4419a4(0x14f)]&&(workerModelIsReady=!![]);}function useThreshold(_0x3c9356){use_threshold=_0x3c9356;}async function setupModel(){const _0x2bc652=_0x4a5885;window['Worker']?(webWorker=new Worker(THREAD_PATH),webWorker[_0x2bc652(0x13d)]=_0x455d46=>postProcessCallback(_0x455d46)):console['error']('Worker\x20thread\x20is\x20not\x20supported');}function setBackgroundImage(_0x4a1b77){const _0x5cded4=_0x4a5885;bg&&bg[_0x5cded4(0x14d)](),imgElement['src']=_0x4a1b77,bgIsUpdated=!![];}async function initialize(_0x12e365,_0x3e88d9,_0x18c390,_0x52aad0,_0x3e8988){const _0x3bbe16=_0x4a5885;try{video_width=_0x52aad0,video_height=_0x3e8988,imgElement=document['getElementById'](_0x18c390),imgElement[_0x3bbe16(0x140)]=video_width,imgElement[_0x3bbe16(0x152)]=video_height,imgElement['hidden']=!![],bg=await tf[_0x3bbe16(0x13b)][_0x3bbe16(0x141)](imgElement),canvasElement=document[_0x3bbe16(0x130)](_0x3e88d9),canvasElement[_0x3bbe16(0x140)]=video_width,canvasElement['height']=video_height,output_ctx=canvasElement[_0x3bbe16(0x148)]('2d'),output_frame=new ImageData(video_width,video_height);const _0x35eb96=document[_0x3bbe16(0x130)](_0x12e365);_0x35eb96['width']=video_width,_0x35eb96[_0x3bbe16(0x152)]=video_height,webcam=await tf[_0x3bbe16(0x149)][_0x3bbe16(0x150)](_0x35eb96),setupModel();}catch(_0x16c05a){console[_0x3bbe16(0x156)](_0x16c05a);}}